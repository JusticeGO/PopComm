% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03_one_step.R
\name{one_step_all}
\alias{one_step_all}
\title{Analyze Ligand-Receptor Pair Correlations and Projection Scores (Across All Cell Types)}
\usage{
one_step_all(
  rna,
  lr_database,
  sample_col,
  cell_type_col,
  min_cells = 50,
  min_samples = 10,
  cor_method = "spearman",
  adjust_method = "BH",
  min_adjust_p = 0.05,
  min_cor = 0,
  min_pct = 0.1,
  num_cores = 10
)
}
\arguments{
\item{rna}{A Seurat object containing single-cell RNA expression data.}

\item{lr_database}{Data frame of LR pairs with columns "ligand_gene_symbol" and "receptor_gene_symbol".}

\item{sample_col}{Column name in metadata indicating sample identifiers (character).}

\item{cell_type_col}{Column name in metadata indicating cell type classifications (character).}

\item{min_cells}{Minimum cells required per sample for both cell types (default 50).}

\item{min_samples}{Minimum valid samples required (default 10).}

\item{cor_method}{Correlation method: "spearman" (default), "pearson", or "kendall".}

\item{adjust_method}{P-value adjustment method (default "BH" for Benjamini-Hochberg).
Options: "holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr", "none".}

\item{min_adjust_p}{Adjusted p-value threshold for significance (default 0.05).}

\item{min_cor}{Minimum correlation coefficient threshold (default 0). Must be â‰¥ 0.}

\item{min_pct}{Minimum percentage of non-zero expression in both ligand and receptor (default 0.1).}

\item{num_cores}{Number of CPU cores for parallel processing (default 10). Automatically capped at (system cores - 1).}
}
\value{
A data frame with columns:
\item{\code{cor_<method>}}{Correlation coefficient (e.g., \code{cor_spearman}).}
\item{\code{p_<method>}}{Raw p-value (e.g., \code{p_spearman}).}
\item{pct1, pct2}{Percent non-zero expression in sender and receiver.}
\item{lr}{Ligand-receptor pair identifier (\code{"Ligand_Receptor"}).}
\item{adjust.p}{Adjusted p-value.}
\item{sender, receiver}{Sending/receiving cell types.}
\item{\code{sample}}{Sample identifier.}
\item{\code{score}}{Projection score (raw co-expression intensity).}
\item{\code{normalized_score}}{Normalized score scaled between 0-1.}
Returns \code{NULL} if no valid pairs in either phase.
}
\description{
Performs integrated analysis of ligand-receptor (LR) pairs through two consecutive phases:
\enumerate{
\item Filters LR pairs and analyzes correlations between specified cell types
\item Calculates projection scores based on regression models for valid pairs.
Returns comprehensive results combining statistical metrics.
}
}
\examples{
seurat_object <- load_example_seurat()
data(lr_db)

# Integrated analysis across all cell types
res_all <- one_step_all(
  rna = seurat_object,
  lr_database = lr_db,
  sample_col = "sample",
  cell_type_col = "cell.type",
  min_cells = 20,
  min_samples = 10,
  min_adjust_p = 0.5,
  num_cores = 1
)

head(res_all$res1)
head(res_all$res2)
}
